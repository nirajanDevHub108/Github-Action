name: 10 -Controlling the execution Flow

on: 
    workflow_dispatch:
            inputs:
                pass-unit-tests:
                   type: boolean
                   description: Whether unit test will pass or not
                   default: true     
jobs:
    lint-build:
        runs-on: ubuntu-latest
        steps:
            - name: Lint and Build
              run: echo "Linting and building"
    unit-tests:
        runs-on: ubuntu-latest
        continue-on-error: true # this will help us to run below step even after failing the above steps
        steps:
            - name: Running unit tests
              run: echo "Running tests....."
            
            - name: Failing tests
              if: ${{!inputs.pass-unit-tests}}
              run: exit 1
    deploy-nonProd:
        runs-on: ubuntu-latest
        needs:
            - lint-build
            - unit-tests
        steps:
            - name : Deploying to nonprod
              run: echo "Deploying to nonprod..."
    
    e2e-tests:
        runs-on: ubuntu-latest
        needs:
            - deploy-nonProd
        steps:
            - name : Running E2E Tests
              run: echo "Running E2E Tests"
    load-tests:
        runs-on: ubuntu-latest
        needs:
            - deploy-nonProd
           
        steps:
            - name : Running Load-Test
              run: echo "Running Load Tests"
    deploy-Production:
        runs-on: ubuntu-latest
        needs:
            - e2e-tests
            - load-tests
        steps:
            - name : Deploying to Production
              run: echo "Deploying to Production..."
    